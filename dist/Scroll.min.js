/*!
bower-scroll v0.0.0 
Javascript component to add a custom styled scroll bar to an element
Build time: Tue May 14 2013 00:31:01 GMT+0100 (BST)
*/

(function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("Scroll",["EventEmitter"],function(EventEmitter){var SuperScroll;return SuperScroll=function(_super){function SuperScroll(container){this.container=container,this.scrollTo=__bind(this.scrollTo,this),this.scrollPercent=__bind(this.scrollPercent,this),this.handleMouseMove=__bind(this.handleMouseMove,this),this.trackClick=__bind(this.trackClick,this),this.trackHandle=__bind(this.trackHandle,this),this.trackScroll=__bind(this.trackScroll,this),this.throttleResize=__bind(this.throttleResize,this),this.onResize=__bind(this.onResize,this),this.hideScroll=__bind(this.hideScroll,this),this.showScroll=__bind(this.showScroll,this),SuperScroll.__super__.constructor.call(this),document.documentElement.className=document.documentElement.className.replace(/\bno-js\b/,"js"),this.scrollPercentDecimal=0,this.scrollContent=this.wrapScrollContent(),this.scrollBar=this.addScrollBar(),this.scrollContent.scrollTo=this.scrollTo,this.maxScroll=Math.max(0,this.scrollContent.getHeight()-this.container.getHeight()),this.maxHandleTop=this.scrollBar.getHeight()-this.handle.getHeight(),container.addEvent('mousewheel:relay(".scroll-content")',this.trackScroll),container.addEvent('mousedown:relay(".handle")',this.trackHandle),container.addEvent('click:relay(".scrollBar")',this.trackClick),document.window.addEvent("resize",this.onResize),this.scrollContent.getHeight()>this.container.getHeight()&&this.showScroll()}return __extends(SuperScroll,_super),SuperScroll.prototype.showScroll=function(){return this.scrollBar.removeClass("hidden")},SuperScroll.prototype.hideScroll=function(){return this.scrollBar.addClass("hidden")},SuperScroll.prototype.onResize=function(){return null!=this.resizeTimeout?(clearTimeout(this.resizeTimeout),this.resizeTimeout=this.throttleResize()):this.resizeTimeout=this.throttleResize()},SuperScroll.prototype.throttleResize=function(){var _this=this;return setTimeout(function(){return _this.maxScroll=Math.max(0,_this.scrollContent.getHeight()-_this.container.getHeight()),_this.maxHandleTop=_this.scrollBar.getHeight()-_this.handle.getHeight(),_this.scrollPercent(_this.scrollPercentDecimal),_this.scrollContent.getHeight()>_this.container.getHeight()?_this.showScroll():_this.hideScroll()},100)},SuperScroll.prototype.wrapScrollContent=function(){return this.container.setStyles({position:"relative",overflow:"hidden"}),this.container.innerHTML='<div class="scroll-content">'+this.container.innerHTML+"</div>",this.container.getChildren(".scroll-content")[0].setStyles({height:"auto",overflow:"hidden"})},SuperScroll.prototype.addScrollBar=function(){var scrollBar;return scrollBar=new Element("div",{"class":"scrollBar hidden",styles:{position:"absolute",height:"100%",top:"0px",right:"0px",cursor:"pointer"}}).grab(this.createHandle()).inject(this.container)},SuperScroll.prototype.createHandle=function(){return this.handle=new Element("div",{"class":"handle",styles:{position:"absolute",top:"0px",left:"0px",width:"100%"}})},SuperScroll.prototype.trackScroll=function(event){var currentMargin,deltaY,newScroll;return deltaY=20*event.wheel,currentMargin=-1*this.scrollContent.getStyle("margin-top").toInt(),newScroll=(currentMargin-deltaY).limit(0,this.maxScroll),this.maxScroll>newScroll&&newScroll>0?(event.stop(),this.scrollPercent(newScroll/this.maxScroll)):void 0},SuperScroll.prototype.trackHandle=function(event){var _this=this;return event.stop(),this.clientY=event.client.y,window.addEvent("mousemove",this.handleMouseMove),window.addEvent("mouseup",function(){return window.removeEvent("mousemove",_this.handleMouseMove)})},SuperScroll.prototype.trackClick=function(event){var barY,clickedY,newTop;return event.target.hasClass("scrollBar")?(clickedY=event.client.y,barY=this.scrollBar.getPosition().y-window.getScroll().y,newTop=clickedY-barY,this.scrollPercent(newTop/this.maxHandleTop)):void 0},SuperScroll.prototype.handleMouseMove=function(event){var deltaY,handleTop,newTop;return deltaY=this.clientY-event.client.y,this.clientY=event.client.y,handleTop=this.handle.getStyle("top").toInt(),newTop=handleTop-deltaY,this.scrollPercent(newTop/this.maxHandleTop)},SuperScroll.prototype.scrollPercent=function(percent){var decimal;return decimal=percent.limit(0,1),this.scrollPercentDecimal=percent,this.handle.setStyle("top",this.maxHandleTop*decimal),this.scrollContent.setStyle("margin-top",-1*this.maxScroll*decimal)},SuperScroll.prototype.scrollTo=function(x,y){return this.scrollPercent(y/this.maxScroll)},SuperScroll}(EventEmitter)})}).call(this);